<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Choir Player</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/7.0.0/wavesurfer.min.js"></script>
</head>
<body>
  <h1>Choir Player</h1>
  <div id="tracks"></div>

  <script>
    // Fetch the track configuration
    fetch('tracks.json')
      .then(response => response.json())
      .then(data => initPlayer(data));

    function initPlayer(tracks) {
      const container = document.getElementById('tracks');
      const howls = {};

      tracks.forEach((track, index) => {
        // Create a Howl instance for each track
        howls[track.title] = new Howl({
          src: [track.file],
          loop: true,
          volume: 1.0
        });

        // Build the UI for each track
        const trackDiv = document.createElement('div');
        trackDiv.classList.add('track');
        trackDiv.innerHTML = `
          <strong>${track.title}</strong>
          <button data-track="${track.title}" class="play-pause">Play</button>
          <button data-track="${track.title}" class="mute">Mute</button>
          <input data-track="${track.title}" type="range" class="volume" min="0" max="1" step="0.1" value="1">
        `;
        container.appendChild(trackDiv);
      });

      // Add event listeners
      container.addEventListener('click', (e) => {
        const trackName = e.target.dataset.track;

        if (e.target.classList.contains('play-pause')) {
          const howl = howls[trackName];
          if (howl.playing()) {
            howl.pause();
            e.target.textContent = 'Play';
          } else {
            howl.play();
            e.target.textContent = 'Pause';
          }
        }

        if (e.target.classList.contains('mute')) {
          const howl = howls[trackName];
          if (howl.volume() > 0) {
            howl.volume(0);
            e.target.textContent = 'Unmute';
          } else {
            howl.volume(1);
            e.target.textContent = 'Mute';
          }
        }
      });

      container.addEventListener('input', (e) => {
        if (e.target.classList.contains('volume')) {
          const trackName = e.target.dataset.track;
          const howl = howls[trackName];
          howl.volume(parseFloat(e.target.value));
        }
      });
    }
  </script>
</body>
</html>
