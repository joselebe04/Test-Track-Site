<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choir Audio Player</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        .audio-player {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            align-items: center;
        }

        .track {
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
        }

        .waveform-container {
            display: flex;
            align-items: center;
            position: relative;
            height: 60px;
        }

        .waveform {
            flex: 1;
            height: 100%;
            margin-left: 10px;
            background: #ccc;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .waveform:hover {
            background: #225588;
            cursor: pointer;
        }

        .locator-line {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: red;
            pointer-events: none;
        }

        .volume-container {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .volume-container input[type="range"] {
            width: 80px;
        }

        .mute-btn {
            background-color: #225588;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 14px;
        }

        .mute-btn.muted {
            background-color: #888;
        }

        .play-btn {
            background-color: #225588;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 16px;
            cursor: pointer;
        }

        .play-btn.paused {
            background-color: #888;
        }

        .timestamp {
            font-size: 12px;
            text-align: right;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="audio-player">
        <div class="controls">
            <button id="playPauseBtn" class="play-btn">Play</button>
            <span id="timestamp" class="timestamp">0:00</span>
        </div>
        
        <div id="tracksContainer">
            <div class="track" id="soprano">
                <span>Soprano</span>
                <div class="waveform-container">
                    <button class="mute-btn" data-track="soprano">Mute</button>
                    <div class="waveform" data-track="soprano">
                        <div class="locator-line" id="locator-soprano"></div>
                    </div>
                </div>
                <div class="volume-container">
                    <input type="range" class="volume-slider" data-track="soprano" min="0" max="100" value="100">
                </div>
            </div>
            
            <div class="track" id="alto">
                <span>Alto</span>
                <div class="waveform-container">
                    <button class="mute-btn" data-track="alto">Mute</button>
                    <div class="waveform" data-track="alto">
                        <div class="locator-line" id="locator-alto"></div>
                    </div>
                </div>
                <div class="volume-container">
                    <input type="range" class="volume-slider" data-track="alto" min="0" max="100" value="100">
                </div>
            </div>

            <div class="track" id="tenor">
                <span>Tenor</span>
                <div class="waveform-container">
                    <button class="mute-btn" data-track="tenor">Mute</button>
                    <div class="waveform" data-track="tenor">
                        <div class="locator-line" id="locator-tenor"></div>
                    </div>
                </div>
                <div class="volume-container">
                    <input type="range" class="volume-slider" data-track="tenor" min="0" max="100" value="100">
                </div>
            </div>

            <div class="track" id="bass">
                <span>Bass</span>
                <div class="waveform-container">
                    <button class="mute-btn" data-track="bass">Mute</button>
                    <div class="waveform" data-track="bass">
                        <div class="locator-line" id="locator-bass"></div>
                    </div>
                </div>
                <div class="volume-container">
                    <input type="range" class="volume-slider" data-track="bass" min="0" max="100" value="100">
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const playPauseBtn = document.getElementById("playPauseBtn");
            const timestamp = document.getElementById("timestamp");
            const muteButtons = document.querySelectorAll(".mute-btn");
            const volumeSliders = document.querySelectorAll(".volume-slider");
            const waveforms = document.querySelectorAll(".waveform");

            let isPlaying = false;
            let tracks = {
                soprano: new Audio("Tracks/Soprano.mp3"),
                alto: new Audio("Tracks/Alto.mp3"),
                tenor: new Audio("Tracks/Tenor.mp3"),
                bass: new Audio("Tracks/Bass.mp3")
            };

            const syncTracks = () => {
                const currentTime = tracks.soprano.currentTime;
                Object.values(tracks).forEach(track => {
                    track.currentTime = currentTime;
                });
            };

            const updateTimestamp = () => {
                const minutes = Math.floor(tracks.soprano.currentTime / 60);
                const seconds = Math.floor(tracks.soprano.currentTime % 60).toString().padStart(2, "0");
                timestamp.textContent = `${minutes}:${seconds}`;
            };

            const updateLocatorLines = () => {
                Object.keys(tracks).forEach(trackName => {
                    const track = tracks[trackName];
                    const locator = document.getElementById(`locator-${trackName}`);
                    const progress = (track.currentTime / track.duration) * 100;
                    locator.style.left = `${progress}%`;
                });
            };

            playPauseBtn.addEventListener("click", () => {
                isPlaying = !isPlaying;
                playPauseBtn.textContent = isPlaying ? "Pause" : "Play";
                Object.values(tracks).forEach(track => {
                    isPlaying ? track.play() : track.pause();
                });
                if (isPlaying) {
                    setInterval(() => {
                        updateTimestamp();
                        updateLocatorLines();
                    }, 500);
                }
            });

            muteButtons.forEach(button => {
                button.addEventListener("click", (e) => {
                    const track = tracks[e.target.dataset.track];
                    const isMuted = track.muted;
                    track.muted = !isMuted;
                    e.target.textContent = isMuted ? "Mute" : "Unmute";
                });
            });

            volumeSliders.forEach(slider => {
                slider.addEventListener("input", (e) => {
                    const track = tracks[e.target.dataset.track];
                    const volume = e.target.value / 100;
                    track.volume = volume;
            
                    // Update mute button if volume is set to 0
                    const muteButton = document.querySelector(`.mute-btn[data-track="${e.target.dataset.track}"]`);
                    if (volume === 0) {
                        track.muted = true;
                        muteButton.textContent = "Unmute";
                    } else {
                        track.muted = false;
                        muteButton.textContent = "Mute";
                    }
                });
            });
            
            waveforms.forEach(waveform => {
                waveform.addEventListener("click", (e) => {
                    const track = tracks[e.target.dataset.track];
                    const rect = e.target.getBoundingClientRect();
                    const clickX = e.clientX - rect.left;
                    const clickPosition = clickX / rect.width;
                    const newTime = track.duration * clickPosition;
            
                    // Sync all tracks to the clicked time
                    Object.values(tracks).forEach(t => t.currentTime = newTime);
                });
            });
            
            // Synchronize all tracks when one ends
            Object.values(tracks).forEach(track => {
                track.addEventListener("ended", () => {
                    isPlaying = false;
                    playPauseBtn.textContent = "Play";
                });
            });
    </script>
</body>
</html>
